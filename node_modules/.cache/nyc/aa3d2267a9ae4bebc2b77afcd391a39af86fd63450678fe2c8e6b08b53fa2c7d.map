{"version":3,"sources":["secure.js"],"names":["secure","protect","req","res","next","token","header","status","send","error","decoded","jwt","verify","user","body","ex"],"mappings":";;;;;;;AAAA;;;;AAEA,IAAMA,MAAM,GAAG;AACbC,EAAAA,OAAO,EAAE,iBAACC,GAAD,EAAMC,GAAN,EAAWC,IAAX,EAAoB;AAE3B,QAAMC,KAAK,GAAGH,GAAG,CAACI,MAAJ,CAAW,OAAX,CAAd;;AACA,QAAI,CAACD,KAAL,EAAY;AACV,aAAOF,GAAG,CAACI,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAC1BD,QAAAA,MAAM,EAAE,GADkB;AAE1BE,QAAAA,KAAK,EAAE;AAFmB,OAArB,CAAP;AAID;;AAED,QAAI;AACF,UAAMC,OAAO,GAAGC,yBAAIC,MAAJ,CAAWP,KAAX,EAAkB,WAAlB,CAAhB;;AACAH,MAAAA,GAAG,CAACW,IAAJ,GAAWH,OAAX;AACAR,MAAAA,GAAG,CAACY,IAAJ,CAAST,KAAT,GAAiBA,KAAjB;AACAD,MAAAA,IAAI;AACL,KALD,CAKE,OAAOW,EAAP,EAAW;AACXZ,MAAAA,GAAG,CAACI,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AACnBD,QAAAA,MAAM,EAAE,GADW;AAEnBE,QAAAA,KAAK,EAAE;AAFY,OAArB;AAID;AACF;AAtBY,CAAf;eAyBeT,M","sourceRoot":"C:\\Users\\idmca\\Desktop\\Andela\\way_farer\\server\\middleware","sourcesContent":["import jwt from 'jsonwebtoken';\r\n\r\nconst secure = {\r\n  protect: (req, res, next) => {\r\n   \r\n    const token = req.header('token');\r\n    if (!token) {\r\n      return res.status(401).send({\r\n        status: 401,\r\n        error: \"Access denied, No token\",\r\n      });\r\n    }\r\n\r\n    try {\r\n      const decoded = jwt.verify(token, \"hidelater\");\r\n      req.user = decoded;\r\n      req.body.token = token;\r\n      next();\r\n    } catch (ex) {\r\n      res.status(400).send({\r\n        status: 400,\r\n        error: \"invalid token\",\r\n      });\r\n    }\r\n  }\r\n}\r\n\r\nexport default secure;"]}